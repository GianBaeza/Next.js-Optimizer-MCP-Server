# üöÄ GitHub Next.js Optimizer MCP Server v2.1

Un servidor MCP (Model Context Protocol) avanzado para an√°lisis de arquitectura, Clean Code y mejores pr√°cticas en repositorios React/Next.js.

## ‚ú® Caracter√≠sticas Principales

### üèóÔ∏è An√°lisis de Arquitectura Avanzado

-   **Clean Architecture**: Detecci√≥n autom√°tica de capas y separaci√≥n de responsabilidades
-   **Principios SOLID**: An√°lisis detallado con ejemplos de refactoring
-   **Patrones de Dise√±o**: Repository, Factory, Observer, Strategy y m√°s
-   **React/Next.js Espec√≠fico**: Optimizaciones de rendimiento y mejores pr√°cticas

### üõ†Ô∏è Caracter√≠sticas T√©cnicas

-   **Auto-Configuraci√≥n Inteligente**: Configuraci√≥n autom√°tica desde token de GitHub
-   **Sistema de Cach√©**: Reduce llamadas a GitHub API con TTL configurable
-   **Rate Limiting**: Manejo inteligente de l√≠mites de API
-   **Logging Estructurado**: Logs detallados con niveles configurables
-   **Validaci√≥n Robusta**: Sanitizaci√≥n de entrada y validaci√≥n de esquemas
-   **Manejo de Errores**: Sistema robusto con retry autom√°tico
-   **Modular**: Arquitectura limpia y extensible

## üîß Instalaci√≥n

### Requisitos Previos

-   **Docker**: v20.10 o superior
-   **Docker Compose**: v2.0 o superior (opcional, pero recomendado)
-   **Git**: Para clonar el repositorio
-   **Token de GitHub**: Con permisos `repo` y `read:user`

> üí° **Nota**: Este proyecto est√° dise√±ado para ejecutarse exclusivamente con Docker. No requiere Node.js instalado localmente.

### Paso 1: Clonar el Repositorio

```bash
git clone https://github.com/GianBaeza/Next.js-Optimizer-MCP-Server.git
cd Next.js-Optimizer-MCP-Server
```

### Paso 2: Construir la Imagen Docker üê≥

```bash
# Opci√≥n A: Usar Docker Compose (RECOMENDADO)
docker-compose build

# Opci√≥n B: Construcci√≥n manual
docker build -t nextjs-optimizer-mcp:latest .
```

**Ventajas de Docker:**

-   ‚úÖ No requiere instalar Node.js v22.20.0 localmente
-   ‚úÖ Ambiente aislado y consistente
-   ‚úÖ Imagen Alpine optimizada (~150MB)
-   ‚úÖ Configuraci√≥n lista para producci√≥n
-   ‚úÖ F√°cil actualizaci√≥n y despliegue

## ‚öôÔ∏è Configuraci√≥n R√°pida

### 1Ô∏è‚É£ Obtener Token de GitHub

1. Ve a [GitHub Settings > Developer Settings > Personal Access Tokens](https://github.com/settings/tokens)
2. Click en "Generate new token (classic)"
3. Selecciona los siguientes permisos:
    - ‚úÖ `repo` (acceso completo a repositorios)
    - ‚úÖ `read:user` (lectura de perfil de usuario)
4. Copia el token generado (comienza con `ghp_`)

### 2Ô∏è‚É£ Configurar Claude Desktop con Docker

Edita tu archivo de configuraci√≥n de Claude Desktop:

**üìç Ubicaci√≥n del archivo:**

-   **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`
-   **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
-   **Linux**: `~/.config/Claude/claude_desktop_config.json`

**üìù Configuraci√≥n para Docker:**

```json
{
    "mcpServers": {
        "github-nextjs-optimizer": {
            "command": "docker",
            "args": [
                "run",
                "--rm",
                "-i",
                "-e",
                "GITHUB_TOKEN=ghp_tu_token_aqui",
                "nextjs-optimizer-mcp:latest"
            ]
        }
    }
}
```

**Par√°metros Docker explicados:**

-   `run`: Ejecuta un nuevo contenedor
-   `--rm`: Elimina el contenedor al terminar
-   `-i`: Modo interactivo (requerido por MCP)
-   `-e GITHUB_TOKEN=...`: Pasa tu token de GitHub
-   `nextjs-optimizer-mcp:latest`: Nombre de la imagen

> **üí° Nota**: El servidor detecta autom√°ticamente tu usuario desde el token. ¬°No necesitas configurar nada m√°s!

### 3Ô∏è‚É£ Variables de Entorno (Opcional)

Puedes personalizar el comportamiento creando un archivo `.env`:

```bash
# GitHub Configuration
GITHUB_TOKEN=ghp_your_token_here

# Cache Settings
GITHUB_CACHE_ENABLED=true
GITHUB_CACHE_TTL=300000

# Analysis Settings
MAX_CONCURRENT_FILES=10
MAX_FILE_SIZE=1048576

# Logging
LOG_LEVEL=info
LOG_FILE_ENABLED=false
LOG_FILE_PATH=./logs/mcp-server.log
```

### 4Ô∏è‚É£ Configuraci√≥n con Docker (Opcional)

Si prefieres usar Docker, edita el archivo `docker-compose.yml`:

```yaml
version: '3.8'

services:
    nextjs-optimizer:
        build:
            context: .
            dockerfile: Dockerfile
        image: nextjs-optimizer-mcp:latest
        container_name: mcp-nextjs-optimizer
        environment:
            - GITHUB_TOKEN=ghp_your_token_here
            - NODE_ENV=production
        volumes:
            - ./logs:/app/logs
        restart: unless-stopped
```

**Comandos √∫tiles de Docker:**

```bash
# Construir y ejecutar
docker-compose up -d

# Ver logs en tiempo real
docker-compose logs -f

# Detener el servidor
docker-compose down

# Reconstruir despu√©s de cambios
docker-compose up -d --build
```

### 5Ô∏è‚É£ Verificar Instalaci√≥n

1. Reinicia Claude Desktop
2. En el chat, verifica que aparezca el servidor conectado
3. Prueba con: `"Analiza mi repositorio GianBaeza/mi-proyecto"`

¬°Listo! üéâ

## üéØ Uso y Herramientas

### ÔøΩ Inicio R√°pido

Una vez configurado, puedes usar el servidor directamente desde Claude:

**Ejemplo 1: Analizar un repositorio completo**

```
Analiza el repositorio GianBaeza/Next.js-Optimizer-MCP-Server
```

**Ejemplo 2: Analizar un archivo espec√≠fico**

```
Analiza el archivo src/components/Button.tsx del repo facebook/react
```

**Ejemplo 3: Obtener sugerencias de arquitectura**

```
Sugiere una arquitectura Clean para mi proyecto web Next.js: usuario/mi-proyecto
```

### üìã Herramientas Disponibles

#### 1Ô∏è‚É£ `listar_archivos_react`

Lista todos los archivos React/Next.js del repositorio organizados por directorio.

**Par√°metros:**

```typescript
{
  owner: string,    // Tu usuario de GitHub (auto-detectado)
  repo: string,     // Nombre del repositorio
  path?: string     // Directorio base (opcional, default: ra√≠z)
}
```

**Ejemplo:**

```
Lista los archivos React de mi repositorio awesome-app
```

---

#### 2Ô∏è‚É£ `analizar_archivo`

Analiza un archivo espec√≠fico aplicando principios de Clean Architecture y SOLID.

**Par√°metros:**

```typescript
{
  owner: string,    // Usuario propietario del repo
  repo: string,     // Nombre del repositorio
  path: string,     // Ruta del archivo
  branch?: string   // Rama (default: main)
}
```

**Ejemplo:**

```
Analiza src/pages/index.tsx de mi repo portfolio
```

---

#### 3Ô∏è‚É£ `analizar_repositorio`

Analiza la arquitectura completa del repositorio con recomendaciones personalizadas.

**Par√°metros:**

```typescript
{
  owner: string,    // Usuario propietario
  repo: string,     // Nombre del repositorio
  branch?: string   // Rama a analizar (default: main)
}
```

**Ejemplo:**

```
Analiza mi repositorio e-commerce-nextjs y dame recomendaciones
```

---

#### 4Ô∏è‚É£ `sugerir_arquitectura`

Sugiere una estructura de Clean Architecture personalizada para el proyecto.

**Par√°metros:**

```typescript
{
  owner: string,
  repo: string,
  projectType?: "web" | "api" | "mobile" | "fullstack" | "library"
}
```

**Ejemplo:**

```
Sugiere arquitectura para mi proyecto API REST: usuario/api-project
```

---

#### 5Ô∏è‚É£ `explicar_patron`

Explica un patr√≥n de dise√±o con ejemplos pr√°cticos en React/Next.js.

**Par√°metros:**

```typescript
{
    patron: string // repository, factory, observer, strategy, etc.
}
```

**Ejemplo:**

```
Expl√≠came el patr√≥n Repository con ejemplo en Next.js
```

## üìä Ejemplo de An√°lisis

### Resultado de An√°lisis Completo

```json
{
    "repository": "GianBaeza/mi-proyecto-nextjs",
    "branch": "main",
    "analysis": {
        "scores": {
            "architecture": 85,
            "cleanCode": 78,
            "overall": 82
        },
        "summary": {
            "total": 12,
            "critical": 1,
            "high": 3,
            "medium": 6,
            "low": 2,
            "info": 0
        },
        "topIssues": [
            {
                "file": "src/components/UserForm.tsx",
                "issue": "Violaci√≥n del SRP (Single Responsibility Principle)",
                "severity": "critical",
                "line": 45,
                "recommendation": "Separa la l√≥gica de validaci√≥n y la l√≥gica de env√≠o en componentes diferentes",
                "designPattern": "Single Responsibility Principle",
                "example": "// Antes\nfunction UserForm() {\n  // validaci√≥n + env√≠o + UI\n}\n\n// Despu√©s\nfunction useUserValidation() { /* ... */ }\nfunction useUserSubmit() { /* ... */ }\nfunction UserForm() { /* solo UI */ }"
            }
        ],
        "suggestions": [
            {
                "title": "Implementar Repository Pattern",
                "description": "Abstrae las llamadas a la API en repositorios dedicados",
                "pattern": "Repository Pattern",
                "benefit": "Mejor desacoplamiento y facilita testing",
                "implementation": "src/repositories/UserRepository.ts"
            }
        ]
    }
}
```

### Interpretaci√≥n de Puntuaciones

**Arquitectura (0-100)**

-   üü¢ **90-100**: Excelente - Sigue Clean Architecture fielmente
-   üü° **70-89**: Buena - Algunas mejoras recomendadas
-   üü† **50-69**: Aceptable - Refactoring recomendado
-   üî¥ **0-49**: Problem√°tica - Refactoring urgente

**Clean Code (0-100)**

-   üü¢ **90-100**: C√≥digo muy limpio y mantenible
-   üü° **70-89**: C√≥digo limpio con mejoras menores
-   üü† **50-69**: C√≥digo aceptable, necesita mejoras
-   üî¥ **0-49**: C√≥digo dif√≠cil de mantener

## üèóÔ∏è Arquitectura del Proyecto

```
src/
‚îú‚îÄ‚îÄ types/              # Definiciones de tipos TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ analysis.ts     # Tipos para an√°lisis de c√≥digo
‚îÇ   ‚îú‚îÄ‚îÄ server.ts       # Tipos de configuraci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ index.ts        # Exportador de tipos
‚îú‚îÄ‚îÄ utils/              # Utilidades del sistema
‚îÇ   ‚îú‚îÄ‚îÄ config.ts       # Sistema de configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ logger.ts       # Sistema de logging
‚îÇ   ‚îú‚îÄ‚îÄ validation.ts   # Validaci√≥n y sanitizaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ cache.ts        # Sistema de cach√© en memoria
‚îÇ   ‚îú‚îÄ‚îÄ errors.ts       # Manejo de errores
‚îÇ   ‚îî‚îÄ‚îÄ index.ts        # Exportador de utilidades
‚îú‚îÄ‚îÄ patterns/           # Patrones de an√°lisis
‚îÇ   ‚îú‚îÄ‚îÄ solid-principles.ts    # Principios SOLID
‚îÇ   ‚îú‚îÄ‚îÄ clean-architecture.ts  # Clean Architecture
‚îÇ   ‚îú‚îÄ‚îÄ react-nextjs.ts       # Patrones React/Next.js
‚îÇ   ‚îú‚îÄ‚îÄ design-patterns.ts    # Patrones de dise√±o
‚îÇ   ‚îî‚îÄ‚îÄ index.ts              # Exportador de patrones
‚îú‚îÄ‚îÄ services/           # Servicios externos
‚îÇ   ‚îú‚îÄ‚îÄ github.ts       # Servicio de GitHub optimizado
‚îÇ   ‚îî‚îÄ‚îÄ index.ts        # Exportador de servicios
‚îú‚îÄ‚îÄ analyzers/          # Analizadores de c√≥digo
‚îÇ   ‚îú‚îÄ‚îÄ code-analyzer.ts # Analizador principal
‚îÇ   ‚îî‚îÄ‚îÄ index.ts         # Exportador de analizadores
‚îú‚îÄ‚îÄ tools/              # Herramientas MCP
‚îÇ   ‚îú‚îÄ‚îÄ basic-tools.ts   # Herramientas b√°sicas
‚îÇ   ‚îú‚îÄ‚îÄ advanced-tools.ts # Herramientas avanzadas
‚îÇ   ‚îî‚îÄ‚îÄ index.ts         # Exportador de herramientas
‚îú‚îÄ‚îÄ tests/              # Suite de tests
‚îÇ   ‚îî‚îÄ‚îÄ basic-tests.ts   # Tests b√°sicos
‚îú‚îÄ‚îÄ index-new.ts        # Servidor principal mejorado
‚îî‚îÄ‚îÄ index.ts            # Servidor original (compatible)
```

## üß™ Testing

```bash
# Ejecutar tests b√°sicos
npm test

# Verificar tipos
npm run lint

# Desarrollo con recarga autom√°tica
npm run dev:new
```

## üìà M√©tricas de Calidad

### Puntuaci√≥n de Arquitectura (0-100)

-   **90-100**: Excelente arquitectura, sigue Clean Architecture
-   **70-89**: Buena arquitectura, algunas mejoras necesarias
-   **50-69**: Arquitectura aceptable, refactoring recomendado
-   **0-49**: Arquitectura problem√°tica, refactoring urgente

### Puntuaci√≥n de Clean Code (0-100)

-   **90-100**: C√≥digo muy limpio y legible
-   **70-89**: C√≥digo limpio con peque√±as mejoras
-   **50-69**: C√≥digo aceptable, algunas mejoras necesarias
-   **0-49**: C√≥digo dif√≠cil de mantener, refactoring necesario

## üîç Patrones Detectados

### Principios SOLID

-   **SRP**: Single Responsibility Principle
-   **OCP**: Open/Closed Principle
-   **LSP**: Liskov Substitution Principle
-   **ISP**: Interface Segregation Principle
-   **DIP**: Dependency Inversion Principle

### Clean Architecture

-   **Domain Layer**: Entidades y reglas de negocio
-   **Application Layer**: Casos de uso
-   **Infrastructure Layer**: Repositorios y servicios
-   **Presentation Layer**: UI y controladores

### Patrones de Dise√±o

-   **Repository**: Abstracci√≥n de datos
-   **Factory**: Creaci√≥n de objetos
-   **Observer**: Comunicaci√≥n entre componentes
-   **Strategy**: Algoritmos intercambiables
-   **Command**: Encapsulaci√≥n de operaciones

### React/Next.js

-   **Performance**: useMemo, useCallback, lazy loading
-   **Architecture**: Component composition, custom hooks
-   **Best Practices**: Key props, conditional rendering
-   **Next.js**: SSR/SSG, API routes, optimization

## üöÄ Novedades v2.1

### ‚ú® Nuevas Caracter√≠sticas

-   **Auto-Configuraci√≥n Inteligente**: Ya no necesitas especificar tu usuario de GitHub, se detecta autom√°ticamente desde el token
-   **Sistema de Cach√© Avanzado**: Reduce llamadas API en 80% con TTL configurable
-   **An√°lisis Concurrente**: Procesa m√∫ltiples archivos en paralelo para mayor velocidad
-   **Validaci√≥n Robusta**: Schemas de validaci√≥n con sanitizaci√≥n autom√°tica
-   **Logging Estructurado**: Logs con rotaci√≥n y niveles configurables (debug, info, warn, error)
-   **Rate Limiting Inteligente**: Manejo autom√°tico de l√≠mites de GitHub API
-   **Error Recovery**: Sistema de retry autom√°tico con backoff exponencial

### üèóÔ∏è Mejoras de Arquitectura

-   **Modularizaci√≥n Completa**: Separaci√≥n en m√≥dulos especializados (types, utils, patterns, services, analyzers, tools)
-   **Inyecci√≥n de Dependencias**: Sistema DI para mejor testeo y mantenibilidad
-   **Configuraci√≥n Flexible**: Variables de entorno con fallbacks sensatos
-   **Extensibilidad**: F√°cil adici√≥n de nuevos patrones y reglas de an√°lisis

### üîÑ Migraci√≥n desde v1.0

Si est√°s usando la versi√≥n anterior:

1. Actualiza tu `claude_desktop_config.json` con la nueva configuraci√≥n (ver arriba)
2. Recompila el proyecto: `npm run build:new`
3. Reinicia Claude Desktop
4. ¬°Ya no necesitas llamar a `configurar_github`! El servidor se auto-configura

## üìù Scripts Disponibles

```bash
# Desarrollo
npm run dev          # Versi√≥n original
npm run dev:new      # Versi√≥n mejorada v2.1

# Compilaci√≥n
npm run build        # Compilar versi√≥n original
npm run build:new    # Compilar versi√≥n mejorada

# Ejecuci√≥n
npm start            # Ejecutar versi√≥n original
npm run start:new    # Ejecutar versi√≥n mejorada

# Testing y calidad
npm test             # Ejecutar tests
npm run lint         # Verificar tipos TypeScript
npm run clean        # Limpiar archivos build
```

## ü§ù Contribuir

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/amazing-feature`)
3. Commit tus cambios (`git commit -m 'Add amazing feature'`)
4. Push a la rama (`git push origin feature/amazing-feature`)
5. Abre un Pull Request

## üìÑ Licencia

MIT License - ver [LICENSE](LICENSE) para m√°s detalles.

‚≠ê **Si este proyecto te ayuda, ¬°dale una estrella en GitHub!**

üöÄ **¬°Lleva tu c√≥digo al siguiente nivel con an√°lisis de arquitectura inteligente!**
